{"ast":null,"code":"\"use client\";import{useState}from\"react\";import apiService from\"../services/api\";import\"./content-box.css\";import docIcon from\"../assets/images/docIcon.png\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ContentBox(){const[text,setText]=useState(\"\");const[summary,setSummary]=useState(\"\");const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(\"\");const[summaryStats,setSummaryStats]=useState(null);const handleFileUpload=event=>{const file=event.target.files[0];if(file&&file.type===\"text/plain\"){const reader=new FileReader();reader.onload=e=>{setText(e.target.result);setSummary(\"\");setSummaryStats(null);setError(\"\");};reader.readAsText(file);}else{setError(\"Chỉ hỗ trợ file .txt\");}};const handleSummarize=async()=>{if(!text.trim()){setError(\"Vui lòng nhập nội dung cần tóm tắt\");return;}if(text.length<50){setError(\"Văn bản quá ngắn để tóm tắt (tối thiểu 50 ký tự)\");return;}setIsLoading(true);setError(\"\");setSummaryStats(null);try{if(!apiService.isAuthenticated()){const sentences=text.match(/[^.!?]+[.!?]?/g);if(!sentences){setSummary(\"Không có nội dung hợp lệ để tóm tắt.\");return;}const summaryText=sentences.slice(0).join(\" \");setSummary(summaryText);setSummaryStats({ai_powered:false,compression_ratio:Math.round(summaryText.length/text.length*100)/100});}else{const response=await apiService.summarizeText(text);setSummary(response.summary_text);setSummaryStats({ai_powered:response.ai_powered,compression_ratio:response.compression_ratio,original_length:response.original_length,summary_length:response.summary_length});}}catch(error){console.error(\"Summarization error:\",error);setError(error.message||\"Có lỗi xảy ra khi tóm tắt văn bản\");const sentences=text.match(/[^.!?]+[.!?]?/g);if(sentences){const summaryText=sentences.slice(0,3).join(\" \");setSummary(summaryText);setSummaryStats({ai_powered:false,compression_ratio:Math.round(summaryText.length/text.length*100)/100});setError(\"Đã sử dụng tóm tắt cơ bản (không kết nối được AI service)\");}}finally{setIsLoading(false);}};const wordCount=text.trim()===\"\"?0:text.trim().split(/\\s+/).length;return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-section\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"text-input\",placeholder:\"Nh\\u1EADp n\\u1ED9i dung t\\u1EA1i \\u0111\\xE2y...\",value:text,onChange:e=>{setText(e.target.value);setError(\"\");},disabled:isLoading}),/*#__PURE__*/_jsx(\"div\",{className:\"controls-section\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"upload-label\",children:[/*#__PURE__*/_jsx(\"img\",{src:docIcon,alt:\"doc-icon\",className:\"docIcon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"upload-text\",children:\"Upload file (.txt)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".txt\",onChange:handleFileUpload,hidden:true,disabled:isLoading})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"summarize-button\",onClick:handleSummarize,disabled:isLoading||!text.trim(),children:isLoading?\"Đang tóm tắt...\":\"Tóm tắt\"}),!apiService.isAuthenticated()&&/*#__PURE__*/_jsx(\"div\",{className:\"guest-notice\",children:\"\\u0110\\u0103ng nh\\u1EADp \\u0111\\u1EC3 s\\u1EED d\\u1EE5ng AI BART model v\\xE0 l\\u01B0u l\\u1ECBch s\\u1EED\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"output-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"output-content\",children:isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0110ang x\\u1EED l\\xFD v\\u1EDBi AI model...\"})]}):summary}),/*#__PURE__*/_jsxs(\"div\",{className:\"output-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"word-count\",children:[wordCount,\" t\\u1EEB\"]}),summaryStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"summary-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"ai-badge \".concat(summaryStats.ai_powered?\"ai-powered\":\"basic\")}),/*#__PURE__*/_jsxs(\"span\",{className:\"compression-ratio\",children:[\"T\\u1EF7 l\\u1EC7 n\\xE9n: \",summaryStats.compression_ratio]})]})]})]})]});}export default ContentBox;","map":{"version":3,"names":["useState","apiService","docIcon","jsx","_jsx","jsxs","_jsxs","ContentBox","text","setText","summary","setSummary","isLoading","setIsLoading","error","setError","summaryStats","setSummaryStats","handleFileUpload","event","file","target","files","type","reader","FileReader","onload","e","result","readAsText","handleSummarize","trim","length","isAuthenticated","sentences","match","summaryText","slice","join","ai_powered","compression_ratio","Math","round","response","summarizeText","summary_text","original_length","summary_length","console","message","wordCount","split","className","children","placeholder","value","onChange","disabled","src","alt","accept","hidden","onClick","concat"],"sources":["D:/Projects/TextSummarizer/text-summarizer_v2/ttvb-frontend/src/components/content-box.jsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport apiService from \"../services/api\"\nimport \"./content-box.css\"\nimport docIcon from \"../assets/images/docIcon.png\"\n\nfunction ContentBox() {\n  const [text, setText] = useState(\"\")\n  const [summary, setSummary] = useState(\"\")\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState(\"\")\n  const [summaryStats, setSummaryStats] = useState(null)\n\n  const handleFileUpload = (event) => {\n    const file = event.target.files[0]\n    if (file && file.type === \"text/plain\") {\n      const reader = new FileReader()\n      reader.onload = (e) => {\n        setText(e.target.result)\n        setSummary(\"\")\n        setSummaryStats(null)\n        setError(\"\")\n      }\n      reader.readAsText(file)\n    } else {\n      setError(\"Chỉ hỗ trợ file .txt\")\n    }\n  }\n\n  const handleSummarize = async () => {\n    if (!text.trim()) {\n      setError(\"Vui lòng nhập nội dung cần tóm tắt\")\n      return\n    }\n\n    if (text.length < 50) {\n      setError(\"Văn bản quá ngắn để tóm tắt (tối thiểu 50 ký tự)\")\n      return\n    }\n\n    setIsLoading(true)\n    setError(\"\")\n    setSummaryStats(null)\n\n    try {\n      if (!apiService.isAuthenticated()) {\n        const sentences = text.match(/[^.!?]+[.!?]?/g)\n        if (!sentences) {\n          setSummary(\"Không có nội dung hợp lệ để tóm tắt.\")\n          return\n        }\n\n        const summaryText = sentences.slice(0).join(\" \")\n        setSummary(summaryText)\n        setSummaryStats({\n          ai_powered: false,\n          compression_ratio: Math.round((summaryText.length / text.length) * 100) / 100,\n        })\n      } else {\n        const response = await apiService.summarizeText(text)\n        setSummary(response.summary_text)\n        setSummaryStats({\n          ai_powered: response.ai_powered,\n          compression_ratio: response.compression_ratio,\n          original_length: response.original_length,\n          summary_length: response.summary_length,\n        })\n      }\n    } catch (error) {\n      console.error(\"Summarization error:\", error)\n      setError(error.message || \"Có lỗi xảy ra khi tóm tắt văn bản\")\n\n      const sentences = text.match(/[^.!?]+[.!?]?/g)\n      if (sentences) {\n        const summaryText = sentences.slice(0, 3).join(\" \")\n        setSummary(summaryText)\n        setSummaryStats({\n          ai_powered: false,\n          compression_ratio: Math.round((summaryText.length / text.length) * 100) / 100,\n        })\n        setError(\"Đã sử dụng tóm tắt cơ bản (không kết nối được AI service)\")\n      }\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const wordCount = text.trim() === \"\" ? 0 : text.trim().split(/\\s+/).length\n\n  return (\n    <div className=\"container\">\n      <div className=\"input-section\">\n        <textarea\n          className=\"text-input\"\n          placeholder=\"Nhập nội dung tại đây...\"\n          value={text}\n          onChange={(e) => {\n            setText(e.target.value)\n            setError(\"\")\n          }}\n          disabled={isLoading}\n        />\n\n        <div className=\"controls-section\">\n          <label className=\"upload-label\">\n            <img src={docIcon} alt=\"doc-icon\" className=\"docIcon\" />\n            <span className=\"upload-text\">Upload file (.txt)</span>\n            <input type=\"file\" accept=\".txt\" onChange={handleFileUpload} hidden disabled={isLoading} />\n          </label>\n        </div>\n\n        {error && <div className=\"error-message\">{error}</div>}\n\n        <button className=\"summarize-button\" onClick={handleSummarize} disabled={isLoading || !text.trim()}>\n          {isLoading ? \"Đang tóm tắt...\" : \"Tóm tắt\"}\n        </button>\n\n        {!apiService.isAuthenticated() && (\n          <div className=\"guest-notice\">Đăng nhập để sử dụng AI BART model và lưu lịch sử</div>\n        )}\n      </div>\n\n      <div className=\"output-section\">\n        <div className=\"output-content\">\n          {isLoading ? (\n            <div className=\"loading\">\n              <div className=\"loading-spinner\"></div>\n              <p>Đang xử lý với AI model...</p>\n            </div>\n          ) : (\n            summary\n          )}\n        </div>\n\n        <div className=\"output-stats\">\n          <div className=\"word-count\">{wordCount} từ</div>\n          {summaryStats && (\n            <div className=\"summary-info\">\n              <span className={`ai-badge ${summaryStats.ai_powered ? \"ai-powered\" : \"basic\"}`}>\n                {/* {summaryStats.ai_powered ? \"Ai model\" : \"Cơ bản\"} */}\n              </span>\n              <span className=\"compression-ratio\">Tỷ lệ nén: {summaryStats.compression_ratio}</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ContentBox"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}